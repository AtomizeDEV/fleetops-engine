{{#if this.noConfigsInstalled}}
    <div class="px-5 my-6">
        <div class="bg-yellow-50 rounded shadow-sm border-l-4 border-yellow-400 p-4">
            <div class="flex items-center">
                <div class="flex-shrink-0 flex items-center">
                    <svg class="h-6 w-6 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="ml-3 flex items-center">
                    <span class="font-extrabold text-xl text-yellow-800">No order configurations installed!</span>
                </div>
            </div>
            <div class="pt-3">
                <p class="text-yellow-700">You currently have no order configs installed, check at the extensions to install an order configuration to get started.</p>
                <div class="flex items-center mt-4">
                    <span class="btn-wrapper inline-flex rounded-md shadow-sm">
                        <LinkToExternal @tagName="button" class="btn btn-warning" @route="extensions">View extensions</LinkToExternal>
                    </span>
                </div>
            </div>
        </div>
    </div>
{{/if}}

<OrderConfig @onConfigsLoaded={{this.setConfigurations}} />

{{!-- <div class="space-y-1">
    <div class="px-5 mt-6">
        <p>Select an order type to configure, or click "New Config" to create a new order type.</p>
    </div>
    <div class="flex items-center justify-between p-4">
        <Select class="w-full flex-1" @value={{this.selectedType}} @options={{this.types}} @optionLabel="name"
                    @optionValue="key" @placeholder="Select order type" @onSelect={{fn (mut this.selectedType)}} />
        <div class="pl-6">
            <Button class="mr-2" @icon="plus" @iconPrefix="fas" @text="New Config" @size="md" />
            <Button @type="primary" @icon="save" @text="Save Changes" @size="md" @onClick={{fn this.saveConfig}} />
        </div>
    </div>

    <div class="w-full h-screen-70">
        {{#if this.typeConfig}}
            <div class="ui-tabs mb-4">
                <nav>
                    <a href="javascript:;" class="ui-tab {{if (eq this.activeTab 'details') 'active'}}" {{on "click" (fn
                        (mut this.activeTab) "details" )}}>
                        Details
                    </a>
                    <a href="javascript:;" class="ui-tab  {{if (eq this.activeTab 'meta') 'active'}}" {{on "click" (fn
                        (mut this.activeTab) "meta" )}} >
                        Meta Fields
                    </a>
                    <a href="javascript:;" class="ui-tab  {{if (eq this.activeTab 'activity') 'active'}}" {{on "click"
                        (fn (mut this.activeTab) "activity" )}}>
                        Activity Flow
                    </a>
                    <a href="javascript:;" class="ui-tab  {{if (eq this.activeTab 'entities') 'active'}}" {{on "click"
                        (fn (mut this.activeTab) "entities" )}}>
                        Entities
                    </a>
                </nav>
            </div>
        {{/if}}

        <EmberScrollable @vertical={{true}}>
            <div class="p-4 mb-20">
                {{#if this.typeConfig}}
                    {{#if (eq this.activeTab "details")}}
                        <div class="content-panel mb-20">
                            <div class="content-panel-header items-center">
                                <h3 class="text-lg font-semibold dark:text-gray-100">
                                    {{this.typeConfig.name}}
                                </h3>
                                <Button @icon="clone" @text="Clone Configuration" @size="sm" @onClick={{fn
                                    this.cloneConfiguration}} />
                            </div>
                            <div class="content-panel-body">
                                <InputGroup @name="Name" @value={{this.typeConfig.name}} />
                                <InputGroup @name="Description" @value={{this.typeConfig.description}} />
                            </div>
                        </div>
                        <div class="flex items-center justify-end my-6">
                            <Button @type="danger" @icon="trash" @text="Delete Configuration" @size="sm" />
                        </div>
                    {{else if (eq this.activeTab "meta")}}
                        <div class="content-panel mb-20">
                            <div class="content-panel-header items-center">
                                <h3 class="text-lg font-semibold dark:text-gray-100">
                                    Meta Fields
                                </h3>
                                <Button @icon="plus" @iconPrefix="fas" @text="New Group" @size="sm" @onClick={{fn
                                    this.addMetaFieldGroup}} />
                            </div>
                            <div class="content-panel-body">
                                <div class="mb-3">
                                    <p>Meta fields configuration will allow you to define custom meta fields that should
                                        be
                                        applied to this
                                        order.</p>
                                </div>

                                <EmberDragula @onDrop={{fn this.moveMetaField}} as |d|>
                                    {{#each this.groupedMetaFields as |group|}}

                                        <div
                                            class="mb-2 border border-blue-500 dark:border-gray-900 p-3 rounded-md shadow-sm">
                                            <div class="flex items-center justify-between mb-3">
                                                <div class="font-semibold dark:text-gray-100">
                                                    {{#if group.value}}
                                                        <span>{{humanize group.value}}</span>
                                                    {{else}}
                                                        <span>Default Fields</span>
                                                    {{/if}}
                                                </div>

                                                <div>
                                                    <Button @icon="plus" @iconPrefix="fas" @text="New Field" @size="sm" @onClick={{fn
                                                        this.addMetaFieldGroup}} />
                                                    {{#if group.value}}
                                                        <Button @type="danger" @icon="times" @iconPrefix="fas"
                                                            @text="Remove Group" @size="sm" @onClick={{fn
                                                            this.removeGroup group.value}} />
                                                    {{/if}}
                                                </div>
                                            </div>

                                            <d.Container data-meta-group-key={{or group.value "default" }}
                                                class="space-y-2">
                                                {{#each group.items as |metaField|}}
                                                    <div class="grid grid-cols-3 gap-2 border border-blue-500 dark:border-gray-900 p-3 rounded-md shadow-sm cursor-move"
                                                        data-meta-field-key={{metaField.key}}>
                                                        <InputGroup @name="Label" @value={{metaField.label}} />
                                                        <div class="input-group">
                                                            <div class="flex items-center justify-between">
                                                                <label class="font-medium flex-1">Field Type</label>

                                                                {{#if (eq metaField.type "select")}}
                                                                    <BasicDropdown @renderInPlace={{false}} as |dd|>
                                                                        <dd.Trigger
                                                                            class="text-xs text-sky-400 cursor-pointer">
                                                                            <FaIcon @icon="cog" class="mr-1" /> Options
                                                                        </dd.Trigger>
                                                                        <dd.Content class="bg-transparent">
                                                                            <div
                                                                                class="w-80 mt-2 rounded shadow-md dark:bg-gray-800">
                                                                                <div
                                                                                    class="border border-gray-300 shdaow-sm rounded dark:border-gray-900">
                                                                                    <div
                                                                                        class="flex items-start justify-between mb-1 p-3">
                                                                                        <Button @type="primary"
                                                                                            @size="xs"
                                                                                            @text="Add Option"
                                                                                            @onClick={{fn
                                                                                            this.addMetaFieldOption
                                                                                            metaField}} />

                                                                                        <div class="flex flex-col space-y-3">
                                                                                            <Toggle @label="Key-Value" @isToggled={{metaField.useKvOptions}} @onToggle={{fn this.toggleMetaFieldKv
                                                                                                metaField}} />
                                                                                                {{#if (not metaField.useKvOptions)}}
                                                                                                    <Toggle @label="Humanize" @isToggled={{metaField.humanizeOptions}} @onToggle={{fn (mut metaField.humanizeOptions)}} />
                                                                                                {{/if}}
                                                                                        </div>
                                                                                    </div>
                                                                                    <EmberDragula @onDragEnd={{fn
                                                                                        this.sortMetaFieldOptions}} as
                                                                                        |dd|>
                                                                                        <dd.Container>
                                                                                            {{#each metaField.options as |option index|}}
                                                                                                {{#if metaField.useKvOptions}}
                                                                                                    <div
                                                                                                        class="z-50 py-2 px-3 mb-2 cursor-move border-b border-gray-300 dark:border-gray-900 last:border-b-0" data-index={{index}}>
                                                                                                        <div class="flex items-start justify-between">
                                                                                                            <FaIcon @icon="grip-lines" class="mr-2" />
                                                                                                            
                                                                                                            <div
                                                                                                                class="flex items-start flex-1">
                                                                                                                <div class="space-y-3 flex flex-col pr-2 flex-1">
                                                                                                                    <Input @type="text" @value={{option.key}} class="form-input form-input-sm" placeholder="Key" />
                                                                                                                    <Input @type="text" @value={{option.value}} class="form-input form-input-sm" placeholder="Value" />
                                                                                                                </div>
                                                                                                                
                                                                                                                <Button
                                                                                                                    @size="xs"
                                                                                                                    @type="danger"
                                                                                                                    @icon="trash"
                                                                                                                    @onClick={{fn
                                                                                                                    this.removeMetaFieldOption
                                                                                                                    metaField
                                                                                                                    option}} />
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                {{else}}
                                                                                                    <div
                                                                                                        class="z-50 grid grid-cols-1 gap-2 py-2 px-3 cursor-move border-b border-gray-300 dark:border-gray-900 last:border-b-0" data-index={{index}}>
                                                                                                        <div
                                                                                                            class="flex items-center">
                                                                                                            <FaIcon @icon="grip-lines" class="mr-2" />
                                                                                                            <Input
                                                                                                                @type="text"
                                                                                                                @value={{option}}
                                                                                                                class="form-input form-input-sm mr-2 flex-1"
                                                                                                                placeholder="Option" />
                                                                                                            <Button
                                                                                                                @size="xs"
                                                                                                                @type="danger"
                                                                                                                @icon="trash"
                                                                                                                @onClick={{fn
                                                                                                                this.removeMetaFieldOption
                                                                                                                metaField
                                                                                                                option}} />
                                                                                                        </div>
                                                                                                    </div>
                                                                                                {{/if}}
                                                                                            {{/each}}
                                                                                        </dd.Container>
                                                                                    </EmberDragula>
                                                                                </div>
                                                                            </div>
                                                                        </dd.Content>
                                                                    </BasicDropdown>
                                                                {{/if}}
                                                            </div>

                                                            <Select class="w-full" @value={{metaField.type}}
                                                                @options={{this.metaFieldTypes}} @optionLabel="label"
                                                                @optionValue="key" @placeholder="Select field type"
                                                                @onSelect={{fn (mut metaField.type)}} />
                                                        </div>
                                                        <InputGroup @name="Description"
                                                            @value={{metaField.description}} />
                                                        <div class="input-group">
                                                            <Checkbox @label="Required" @onToggle={{fn (mut
                                                                metaField.required)}} @value={{metaField.required}} />
                                                        </div>
                                                    </div>
                                                {{/each}}
                                            </d.Container>
                                        </div>

                                    {{/each}}
                                </EmberDragula>
                            </div>
                        </div>
                    {{else if (eq this.activeTab "activity")}}
                        <div class="content-panel mb-20">
                            <div class="content-panel-header items-center">
                                <h3 class="text-lg font-semibold dark:text-gray-100">
                                    Activity Flow
                                </h3>

                                <Button @icon="plus" @iconPrefix="fas" @text="New Status" @size="sm" />
                            </div>
                            <div class="content-panel-body">
                                <div class="mb-3">
                                    <p>Activity flow configuration will allow you to define the different types of
                                        tracking
                                        status
                                        activities that apply for
                                        this
                                        order type. Logic of the activity flow can also be configured.</p>
                                </div>

                                {{#if this.typeConfig.meta.flow}}
                                    {{#each-in this.typeConfig.meta.flow as |status events|}}
                                        <div class="grid grid-cols-4 gap-2 mb-4">
                                            <div>
                                                <Badge @status={{status}} />
                                                <div>
                                                    <Button @size="xs" @text="New Activity" @icon="plus" @iconPrefix="fas" class="my-2" />
                                                </div>
                                                <div class="mb-3">
                                                    <p class="datk:rext-gray-50 text-xs">
                                                        The right side shows the next available activity options for the status `{{status}}`, 
                                                        logic stacks can be applied to determine if the next activity can be applied to the order.
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="col-span-3 space-y-3">
                                                {{#each events as |event|}}
                                                    <div class="rounded shadow-sm border border-gray-300 dark:border-gray-900">
                                                        <div class="border-b border-gray-300 dark:border-gray-900 p-3 mb-2">
                                                            <div class="mb-4 flex items-center justify-between">
                                                                <div>
                                                                    <FaIcon @icon="project-diagram" class="mr-2 dark:text-sky-300" />
                                                                    <span class="dark:text-gray-100 text-sm">Logic Stack</span>
                                                                </div>
                                                                <Button @size="xs" @text="Add logic condition" @icon="plus" @iconPrefix="fas" @onClick={{fn this.addLogicCondition
                                                                    event}} />
                                                            </div>
                                                            {{#if event.if}} 
                                                                <div class="space-y-2">
                                                                    {{#each event.if as |logic conditionIndex|}}
                                                                        <div class="grid grid-cols-5 gap-2">
                                                                            <div class="flex items-center col-span-2">
                                                                                <div class="py-2 px-3 rounded flex items-center justify-center text-center text-sm font-bold text-mono mr-3 dark:text-gray-50 border border-gray-50 dark:border-gray-900">
                                                                                    if
                                                                                </div>
                                                                                <Select @options={{this.configFields}} @value={{get logic 0}} @placeholder="Select field" class="flex-1 w-full" @onSelect={{fn this.updateActivityLogic event conditionIndex 0}} />
                                                                            </div>
                                                                            <Select @options={{this.logicOperators}} @value={{get logic 1}} @optionLabel="label" @optionValue="value" @onSelect={{fn this.updateActivityLogic event conditionIndex 1}}  @placeholder="Select operator" />
                                                                            <div class="flex items-center col-span-2">
                                                                                <Input @type="text" @value={{get logic 2}} @onKeyUp={{fn this.updateActivityLogic event conditionIndex 2}} placeholder="Enter value to compare" class="form-input w-full flex-1 mr-3" />
                                                                                <Button @size="sm" @icon="trash" @onClick={{fn this.removeLogicCondition event logic}} />
                                                                            </div>
                                                                        </div>
                                                                    {{/each}}
                                                                </div>
                                                            {{else}}
                                                                <div class="flex items-center justify-center">
                                                                    <div class="rounded bg-gray-300 dark:bg-gray-700 shadow-sm text-sm text-center px-6 py-3 dark:text-gray-100 border border-dashed border-gray-500 dark:border-gray-900">No logic conditions applied</div>
                                                                </div>
                                                            {{/if}}
                                                        </div>

                                                        <div class="p-3">
                                                            <InputGroup @name="Status" @value={{event.status}} />
                                                            <InputGroup @name="Details" @value={{event.details}} />
                                                            <InputGroup @name="Code" @value={{event.code}} />
                                                        </div>
                                                    </div>
                                                {{/each}}
                                            </div>
                                        </div>
                                    {{/each-in}}
                                {{/if}}
                            </div>
                        </div>
                    {{else if (eq this.activeTab "entities")}}
                        <div class="content-panel mb-20">
                            <div class="content-panel-header items-center">
                                <h3 class="text-lg font-semibold dark:text-gray-100">
                                    Entities
                                </h3>

                                <Button @text="New Entity Type" @icon="plus" @iconPrefix="fas" />
                            </div>
                            <div class="content-panel-body">
                                <div class="mb-3">
                                    <p>Entities configuration will allow you to define the different type of entities
                                        that
                                        should be
                                        selectable for this
                                        order type. These should be used like templates to make manual order creation faster.</p>
                                </div>

                                <div class="space-y-3">
                                    {{#if this.typeConfig.meta.entities}}
                                        {{#each this.typeConfig.meta.entities as |entity|}}
                                            <div class="rounded shadow-sm border border-gray-300 dark:border-gray-900">
                                                <div class="border-b border-gray-300 dark:border-gray-900 p-3 mb-2">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <FaIcon @icon="box-alt" class="mr-2 dark:text-sky-300" />
                                                            <span class="dark:text-gray-100 text-sm mr-1">Entity Type</span>
                                                            <span class="dark:text-gray-100 text-sm">({{entity.name}})</span>
                                                        </div>
                                                        <Button @size="xs" @text="Add meta field" @icon="plus" @iconPrefix="fas" />
                                                    </div>
                                                </div>
                                                <div class="p-3">
                                                    <div class="grid grid-cols-3 gap-2">
                                                        <InputGroup @name="Name" @value={{entity.name}} />
                                                        <InputGroup @name="Type" @value={{entity.type}} />
                                                        <InputGroup @name="Description" @value={{entity.description}} class="col-span-2" />
                                                    </div>
                                    
                                                    <div class="grid grid-cols-5 gap-2">
                                                        <InputGroup @name="Weight" @value={{entity.weight}} class="col-span-3" />
                                                        <InputGroup @name="Unit">
                                                            <Select @value={{entity.weight_unit}} @options={{this.weightUnits}} class="w-full" />
                                                        </InputGroup>
                                                    </div>
                                    
                                                    <div class="grid grid-cols-5 gap-2">
                                                        <InputGroup @name="Length" @value={{entity.length}} />
                                                        <InputGroup @name="Width" @value={{entity.width}} />
                                                        <InputGroup @name="Height" @value={{entity.width}} />
                                                        <InputGroup @name="Unit">
                                                            <Select @value={{entity.dimentions_unit}} @options={{this.dimensionUnits}} class="w-full" />
                                                        </InputGroup>
                                                    </div>
                                                </div>
                                            </div>
                                        {{/each}}
                                    {{/if}}
                                </div>
                                
                            </div>
                        </div>
                    {{/if}}
                {{/if}}
            </div>
        </EmberScrollable>
    </div>
</div> --}}